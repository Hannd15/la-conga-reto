<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa de Humedales en Colombia</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script>
        function escapeHtml(text) {
            return text.replace(/&/g, "&")
                       .replace(/</g, "<")
                       .replace(/>/g, ">")
                       .replace(/"/g, '"')
                       .replace(/'/g, "'");
        }

        function calculateZoomLevel(area) {
            if (area > 250000) {
                return 8.75;
            } else if (area > 37500) {
                return 10;
            } else if (area > 1000) {
                return 11.5;
            } else {
                return 12.75;
            }
        }

        function showWetlandInfo(name, territory, designationDate, area, summary, lat, lon) {
            const zoomLevel = calculateZoomLevel(parseFloat(area));
            document.getElementById('wetland-info').innerHTML = `
                <b>Nombre:</b> ${escapeHtml(name)}<br>
                <b>Territorio:</b> ${escapeHtml(territory)}<br>
                <b>Fecha de Designación:</b> ${escapeHtml(designationDate)}<br>
                <b>Área:</b> ${escapeHtml(area)} ha<br>
            `;
            document.getElementById('timelapse').src = `https://earthengine.google.com/iframes/timelapse_player_embed.html#v=${lat},${lon},${zoomLevel},latLng&t=3.83&ps=25&bt=19840101&et=20221231`;
        }
    </script>
</head>
<body>
    <div class="container">
        <div class="content">
            <h1>Mapa de Humedales en Colombia</h1>
            <div class="map">
                <iframe src="{{ url_for('static', filename='map.html') }}" width="100%" height="800" frameborder="0"></iframe>
            </div>
        </div>
        <div class="info">
            <h4>Información del Humedal</h4>
            <p id="wetland-info">Selecciona un humedal para ver la información.</p>
            <iframe id="timelapse" width="1080" height="600" src="" frameborder="0" allowfullscreen></iframe>
        </div>
    </div>
</body>
</html>
